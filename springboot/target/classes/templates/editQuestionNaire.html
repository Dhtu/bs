<!DOCTYPE html>
<html xmlns:v-on="http://www.w3.org/1999/xhtml" lang="cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="./js/jquery.min.js"></script>
    <script src="./js/vue.min.js"></script>
    <script src="./js/axios.min.js"></script>
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <script src="./js/bootstrap.min.js"></script>
    <style type="text/css">
        div#app {
            margin: 20px auto;
            width: 400px;
            padding: 20px;
        }
    </style>
    <title>编辑问卷</title>
</head>

<body>
<div id="app">
    <div id="div4Update">

        <div class="input-group input-group">
            <label>
                <input type="text" class="form-control" placeholder="title" aria-describedby="basic-addon1"
                       v-model="questionNaires4add.title"/>
            </label>
        </div>
        <div class="input-group">
            <label>
                <input type="text" class="form-control" placeholder="info" aria-describedby="basic-addon1"
                       v-model="questionNaires4add.info"/>
            </label>
        </div>
        <div class="input-group input-group">
            <label>
                <input type="number" class="form-control" placeholder="itemInfo" aria-describedby="basic-addon1"
                       v-model="questionNaires4add.uid"/>
            </label>
        </div>
        <div class="input-group input-group">
            <label>
                <input type="number" class="form-control" placeholder="itemInfo" aria-describedby="basic-addon1"
                       v-model="questionNaires4add.authority"/>
            </label>
        </div>
        <div class="input-group input-group">
            <label>
                <input type="number" class="form-control" placeholder="itemInfo" aria-describedby="basic-addon1"
                       v-model="questionNaires4add.itemType"/>
            </label>
        </div>
        <div class="input-group input-group">
            <label>
                <input type="text" class="form-control" placeholder="itemInfo" aria-describedby="basic-addon1"
                       v-model="questionNaires4add.itemInfo"/>
            </label>
        </div>
        <input type="hidden" v-model="questionNaires4add.qid"/>
        <br>
        <button type="button" class="btn btn-info" v-on:click="update">修改</button>
        <button type="button" class="btn btn-danger" v-on:click="cancel">取消</button>

    </div>
</div>

<script type="text/javascript">
    //获取地址栏参数的函数
    function getUrlParms(name) {
        let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        let r = window.location.search.substr(1).match(reg);
        if (r != null)
            return unescape(r[2]);
        return null;
    }

    let data4Vue = {
        questionNaires: [],
        questionNaires4add: {qid: 0, title: '', info: '', uid: 0, authority: 0, itemType: 0, itemInfo: ''},
    };

    //ViewModel
    let vue = new Vue({
        el: '#app',
        data: data4Vue,
        mounted: function () { //mounted　表示这个 Vue 对象加载成功了
            this.get();
        },
        methods: {
            get: function () {
                let qid = getUrlParms("qid");
                let url = "QuestionNaires/" + qid;
                console.log(url);
                axios.get(url).then(function (response) {
                    vue.questionNaires4add = response.data;
                })
            },
            update: function () {
                let url = "QuestionNaires/" + vue.questionNaires4add.qid;
                axios.put(url, vue.questionNaires4add).then(function () {
                    location.href = "listQuestionNaire";
                });
            },
            cancel: function () {
                location.href = "listQuestionNaire";
            }
        }
    });
</script>
</body>
</html>
